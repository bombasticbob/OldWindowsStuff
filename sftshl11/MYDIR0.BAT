@ECHO OFF
REM
REM   BEGINNING OF PROGRAM
REM
:MAINLOOP
LET in=INPUT("Enter File specification (Blank line to end): ")
REM
REM   TRIM OFF UNNECESSARY JUNK (WHITE-SPACE)
REM
LET in=LTRIM(RTRIM(in))
REM
REM   BLANK STRING?  END PROGRAM
REM
IF (LEN(in)=0) GOTO THE_END
REM
REM   GET FILE LISTING INTO ARRAY 'b'
REM
LET b=DIRLIST(in)
REM
REM   IF THERE ARE NO FILES, b[1] WILL BE 'blank'
REM
IF (LEN(b[1])) GOTO THERE_ARE_FILES
REM
ECHO ?No files matching critieria
GOTO MAINLOOP
REM
REM
:THERE_ARE_FILES
REM
LET c=b[0]
REM     ** note - arrays do not expand when placed in '%%' **
REM
ECHO Directory for %c%
REM
REM     INITIALIZE COUNTER FOR LOOP 'ctr'
REM
LET ctr=1
REM
REM
:FILE_LOOP
REM
REM     WHEN WE ARE DONE WITH THE FILE LIST, 'b[ctr]' WILL BE A
REM     STRING CONSISTING OF ONLY 'WHITE-SPACE'.  IF WE TRIM
REM     ALL OF THE WHITE SPACE, AND THE LENGTH IS ZERO, WE
REM     ARE THEREFORE DONE WITH THE LOOP!
REM
IF NOT (LEN(LTRIM(RTRIM(b[ctr])))) GOTO FILE_LOOP_DONE
REM
REM     USING THE 'FILEINFO()' FUNCTION OBTAIN INFO ABOUT FILE
REM     NOTE THAT WE CONCATENATE THE NAME IN 'b[ctr]' ONTO THE
REM     FULLY QUALIFIED PATHNAME 'b[0]' USING THE '++' OPERATOR
REM
LET c=FILEINFO(b[0]++b[ctr])
REM
REM     EXTRACT EACH FIELD FROM THE ARRAY 'c'
REM
LET name=c[0]
LET attr=c[2]
LET size=c[3]
LET date_time=c[4]
LET type=c[5]
LET dt=DATE(date_time)
LET tm=TIME(date_time)
REM
REM     ** FORMAT ITEMS FOR DISPLAY **
REM     ** DEMO OF FORMAT UTILITIES **
REM
LET name=LJ(LEFT(name++"             ",13))
LET attr=LJ(LEFT(attr++"        ",8))
LET size=RJ(LEFT(size++"          ",10))
LET type=LJ(LEFT(type++"        ",8))
REM
ECHO %name% %attr% %size% %dt% %tm% %type%
REM
REM    CONTINUE WITH THE LOOP
REM
LET ctr=ctr+1
GOTO FILE_LOOP
REM
REM
:FILE_LOOP_DONE
ECHO.
ECHO.
GOTO MAINLOOP
REM
REM   *** WHEN THE USER TYPES A BLANK LINE, THE PROGRAM GOES HERE ***
REM
:THE_END
ECHO.
ECHO.
ECHO ** FINISHED **
REM
REM ** end of program **
REM
